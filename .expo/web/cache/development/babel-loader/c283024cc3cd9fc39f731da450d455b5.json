{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport useWindowDimensions from \"react-native-web/dist/exports/useWindowDimensions\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport React, { useEffect, useState } from \"react\";\nimport SecHeader from \"../components/SecHeader\";\nimport styles from \"./styles\";\nimport PaymentInput from \"../components/PaymentInput\";\nimport CustomeBtn from \"../components/CustomeBtn\";\nimport Logout from \"../components/Logout\";\nimport { deleteDoc, collection, query, where, getDocs, onSnapshot } from 'firebase/firestore';\nimport { auth, firestore } from \"./firebaseConfig/firebase\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Payment(_ref) {\n  var navigation = _ref.navigation,\n      route = _ref.route;\n\n  var _useWindowDimensions = useWindowDimensions(),\n      height = _useWindowDimensions.height,\n      width = _useWindowDimensions.width;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isPopUp = _useState2[0],\n      setIsPopUp = _useState2[1];\n\n  var _useState3 = useState(false),\n      _useState4 = _slicedToArray(_useState3, 2),\n      isLoading = _useState4[0],\n      setIsLoading = _useState4[1];\n\n  var userId = auth.currentUser.uid;\n  var totalPrice = route.params.totalPrice;\n\n  function toCart() {\n    navigation.navigate('Cart');\n  }\n\n  function prevPage() {\n    navigation.goBack();\n  }\n\n  function logout() {\n    navigation.navigate('Login');\n  }\n\n  function pay() {\n    setIsLoading(true);\n    var collectionRef = collection(firestore, 'cart');\n    var dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\n\n    try {\n      getDocs(dataQuery).then(function (snapshot) {\n        snapshot.docs.forEach(function (doc) {\n          deleteDoc(doc.ref).then(function () {\n            setIsLoading(false);\n            navigation.navigate('Home');\n          });\n        });\n      });\n    } catch (e) {\n      console.log(e.message);\n    }\n  }\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      cartValue = _useState6[0],\n      setCartValue = _useState6[1];\n\n  useEffect(function () {\n    var collectionRef = collection(firestore, 'cart');\n\n    try {\n      var dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\n      onSnapshot(dataQuery, function (snapshot) {\n        var data = snapshot.docs.map(function (doc) {\n          return _objectSpread(_objectSpread({}, doc.data()), {}, {\n            id: doc.id\n          });\n        });\n        console.log(data);\n        setCartValue(data.length);\n      });\n    } catch (e) {\n      console.log(e.message);\n    }\n  }, []);\n  return _jsxs(SafeAreaView, {\n    style: styles.container,\n    children: [isPopUp && _jsx(Logout, {\n      logout: logout,\n      setIsPopUp: setIsPopUp\n    }), _jsxs(View, {\n      style: {\n        marginTop: '8%'\n      },\n      children: [_jsx(SecHeader, {\n        setIsPopUp: setIsPopUp,\n        cartValue: cartValue,\n        toCart: toCart,\n        prevPage: prevPage\n      }), _jsx(Text, {\n        style: _objectSpread(_objectSpread({}, styles.catText), {}, {\n          marginLeft: '5%'\n        }),\n        children: \"Payment\"\n      }), _jsxs(View, {\n        style: {\n          width: '100%',\n          alignItems: 'center'\n        },\n        children: [_jsx(PaymentInput, {\n          placeholder: \"Bank name\"\n        }), _jsx(PaymentInput, {\n          placeholder: \"Card number\"\n        }), _jsx(PaymentInput, {\n          placeholder: \"Cvv\"\n        }), _jsx(PaymentInput, {\n          placeholder: \"Expiry date\"\n        })]\n      }), _jsx(View, {\n        style: {\n          height: height * 0.05\n        }\n      }), _jsxs(Text, {\n        style: _objectSpread(_objectSpread({}, styles.catPara), {}, {\n          marginLeft: '5%'\n        }),\n        children: [\"Total Price: R\", totalPrice.toFixed(2)]\n      }), _jsx(View, {\n        style: {\n          height: height * 0.05\n        }\n      }), _jsx(CustomeBtn, {\n        name: \"Pay\",\n        onPress: function onPress() {\n          return pay();\n        }\n      })]\n    }), isLoading && _jsx(ActivityIndicator, {\n      size: \"large\",\n      color: \"#000000\"\n    })]\n  });\n}","map":{"version":3,"names":["React","useEffect","useState","SecHeader","styles","PaymentInput","CustomeBtn","Logout","deleteDoc","collection","query","where","getDocs","onSnapshot","auth","firestore","Payment","navigation","route","useWindowDimensions","height","width","isPopUp","setIsPopUp","isLoading","setIsLoading","userId","currentUser","uid","totalPrice","params","toCart","navigate","prevPage","goBack","logout","pay","collectionRef","dataQuery","then","snapshot","docs","forEach","doc","ref","e","console","log","message","cartValue","setCartValue","data","map","id","length","container","marginTop","catText","marginLeft","alignItems","catPara","toFixed"],"sources":["C:/Users/user/Downloads/ResturantApp/pages/Payment.js"],"sourcesContent":["import { View, Text, SafeAreaView, useWindowDimensions, ActivityIndicator } from \"react-native\";\r\nimport React, {useEffect, useState} from \"react\";\r\nimport SecHeader from \"../components/SecHeader\";\r\nimport styles from \"./styles\";\r\nimport PaymentInput from \"../components/PaymentInput\";\r\nimport CustomeBtn from \"../components/CustomeBtn\";\r\nimport Logout from \"../components/Logout\";\r\nimport {deleteDoc, collection, query,where,getDocs, onSnapshot} from 'firebase/firestore';\r\nimport {auth, firestore} from './firebaseConfig/firebase';\r\n\r\nexport default function Payment({navigation,route}) {\r\n    const {height, width} = useWindowDimensions();\r\n    const [isPopUp, setIsPopUp] = useState(false);\r\n    const [isLoading,setIsLoading] = useState(false);\r\n    const userId = auth.currentUser.uid;\r\n\r\n    const {totalPrice} = route.params;\r\n    function toCart(){\r\n        navigation.navigate('Cart')\r\n      }\r\n      function prevPage(){\r\n        navigation.goBack();\r\n      }\r\n      function logout(){\r\n        navigation.navigate('Login')\r\n    }\r\n\r\n    function pay(){\r\n      setIsLoading(true)\r\n      const collectionRef = collection(firestore, 'cart');\r\n      let dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\r\n      try{\r\n        getDocs(dataQuery).then((snapshot)=>{\r\n        snapshot.docs.forEach(doc=>{\r\n          deleteDoc(doc.ref).then(()=>{\r\n            setIsLoading(false);\r\n            navigation.navigate('Home')\r\n          });\r\n        })\r\n      });\r\n      }catch(e){\r\n        console.log(e.message);\r\n      }\r\n      \r\n    }\r\n\r\n    const [cartValue,setCartValue] = useState(0);\r\n   \r\nuseEffect(()=>{\r\n  const collectionRef = collection(firestore, 'cart');\r\n  \r\n        try {\r\n          let dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\r\n          \r\n          onSnapshot(dataQuery, (snapshot) => {\r\n            let data= snapshot.docs.map((doc)=>({...doc.data(), id: doc.id}));\r\n            console.log(data);\r\n            setCartValue(data.length);\r\n          })\r\n          \r\n          \r\n        //   console.log(data.length);\r\n          \r\n        }catch(e){\r\n            console.log(e.message);\r\n        \r\n        }\r\n},[])\r\n\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n      {isPopUp&&<Logout logout={logout} setIsPopUp={setIsPopUp} />}\r\n        <View style={{marginTop: '8%'}}>\r\n        \r\n        <SecHeader setIsPopUp={setIsPopUp} cartValue={cartValue} toCart={toCart} prevPage={prevPage} />\r\n        <Text style={{...styles.catText, marginLeft: '5%'}}>Payment</Text>\r\n        <View style={{width: '100%', alignItems: 'center'}}>\r\n            <PaymentInput placeholder='Bank name' />\r\n            <PaymentInput placeholder='Card number' />\r\n            <PaymentInput placeholder='Cvv' />\r\n            <PaymentInput placeholder='Expiry date' />\r\n        </View>\r\n        <View style={{height: height *0.05}} />\r\n        <Text style={{...styles.catPara, marginLeft: '5%'}}>Total Price: R{totalPrice.toFixed(2)}</Text>\r\n        <View style={{height: height *0.05}} />\r\n        <CustomeBtn name='Pay' onPress={()=>pay()} />\r\n        </View>\r\n        {isLoading&&<ActivityIndicator size=\"large\" color=\"#000000\" />}\r\n    </SafeAreaView>\r\n  );\r\n}\r\n"],"mappings":";;;;;;;;;;;;AACA,OAAOA,KAAP,IAAeC,SAAf,EAA0BC,QAA1B,QAAyC,OAAzC;AACA,OAAOC,SAAP;AACA,OAAOC,MAAP;AACA,OAAOC,YAAP;AACA,OAAOC,UAAP;AACA,OAAOC,MAAP;AACA,SAAQC,SAAR,EAAmBC,UAAnB,EAA+BC,KAA/B,EAAqCC,KAArC,EAA2CC,OAA3C,EAAoDC,UAApD,QAAqE,oBAArE;AACA,SAAQC,IAAR,EAAcC,SAAd;;;AAEA,eAAe,SAASC,OAAT,OAAqC;EAAA,IAAnBC,UAAmB,QAAnBA,UAAmB;EAAA,IAARC,KAAQ,QAARA,KAAQ;;EAChD,2BAAwBC,mBAAmB,EAA3C;EAAA,IAAOC,MAAP,wBAAOA,MAAP;EAAA,IAAeC,KAAf,wBAAeA,KAAf;;EACA,gBAA8BnB,QAAQ,CAAC,KAAD,CAAtC;EAAA;EAAA,IAAOoB,OAAP;EAAA,IAAgBC,UAAhB;;EACA,iBAAiCrB,QAAQ,CAAC,KAAD,CAAzC;EAAA;EAAA,IAAOsB,SAAP;EAAA,IAAiBC,YAAjB;;EACA,IAAMC,MAAM,GAAGZ,IAAI,CAACa,WAAL,CAAiBC,GAAhC;EAEA,IAAOC,UAAP,GAAqBX,KAAK,CAACY,MAA3B,CAAOD,UAAP;;EACA,SAASE,MAAT,GAAiB;IACbd,UAAU,CAACe,QAAX,CAAoB,MAApB;EACD;;EACD,SAASC,QAAT,GAAmB;IACjBhB,UAAU,CAACiB,MAAX;EACD;;EACD,SAASC,MAAT,GAAiB;IACflB,UAAU,CAACe,QAAX,CAAoB,OAApB;EACH;;EAED,SAASI,GAAT,GAAc;IACZX,YAAY,CAAC,IAAD,CAAZ;IACA,IAAMY,aAAa,GAAG5B,UAAU,CAACM,SAAD,EAAY,MAAZ,CAAhC;IACA,IAAIuB,SAAS,GAAG5B,KAAK,CAAC2B,aAAD,EAAgB1B,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBe,MAAjB,CAArB,CAArB;;IACA,IAAG;MACDd,OAAO,CAAC0B,SAAD,CAAP,CAAmBC,IAAnB,CAAwB,UAACC,QAAD,EAAY;QACpCA,QAAQ,CAACC,IAAT,CAAcC,OAAd,CAAsB,UAAAC,GAAG,EAAE;UACzBnC,SAAS,CAACmC,GAAG,CAACC,GAAL,CAAT,CAAmBL,IAAnB,CAAwB,YAAI;YAC1Bd,YAAY,CAAC,KAAD,CAAZ;YACAR,UAAU,CAACe,QAAX,CAAoB,MAApB;UACD,CAHD;QAID,CALD;MAMD,CAPC;IAQD,CATD,CASC,OAAMa,CAAN,EAAQ;MACPC,OAAO,CAACC,GAAR,CAAYF,CAAC,CAACG,OAAd;IACD;EAEF;;EAED,iBAAiC9C,QAAQ,CAAC,CAAD,CAAzC;EAAA;EAAA,IAAO+C,SAAP;EAAA,IAAiBC,YAAjB;;EAEJjD,SAAS,CAAC,YAAI;IACZ,IAAMoC,aAAa,GAAG5B,UAAU,CAACM,SAAD,EAAY,MAAZ,CAAhC;;IAEM,IAAI;MACF,IAAIuB,SAAS,GAAG5B,KAAK,CAAC2B,aAAD,EAAgB1B,KAAK,CAAC,QAAD,EAAW,IAAX,EAAiBe,MAAjB,CAArB,CAArB;MAEAb,UAAU,CAACyB,SAAD,EAAY,UAACE,QAAD,EAAc;QAClC,IAAIW,IAAI,GAAEX,QAAQ,CAACC,IAAT,CAAcW,GAAd,CAAkB,UAACT,GAAD;UAAA,uCAAYA,GAAG,CAACQ,IAAJ,EAAZ;YAAwBE,EAAE,EAAEV,GAAG,CAACU;UAAhC;QAAA,CAAlB,CAAV;QACAP,OAAO,CAACC,GAAR,CAAYI,IAAZ;QACAD,YAAY,CAACC,IAAI,CAACG,MAAN,CAAZ;MACD,CAJS,CAAV;IASD,CAZD,CAYC,OAAMT,CAAN,EAAQ;MACLC,OAAO,CAACC,GAAR,CAAYF,CAAC,CAACG,OAAd;IAEH;EACR,CAnBQ,EAmBP,EAnBO,CAAT;EAqBE,OACE,MAAC,YAAD;IAAc,KAAK,EAAE5C,MAAM,CAACmD,SAA5B;IAAA,WACGjC,OAAO,IAAE,KAAC,MAAD;MAAQ,MAAM,EAAEa,MAAhB;MAAwB,UAAU,EAAEZ;IAApC,EADZ,EAEI,MAAC,IAAD;MAAM,KAAK,EAAE;QAACiC,SAAS,EAAE;MAAZ,CAAb;MAAA,WAEA,KAAC,SAAD;QAAW,UAAU,EAAEjC,UAAvB;QAAmC,SAAS,EAAE0B,SAA9C;QAAyD,MAAM,EAAElB,MAAjE;QAAyE,QAAQ,EAAEE;MAAnF,EAFA,EAGA,KAAC,IAAD;QAAM,KAAK,kCAAM7B,MAAM,CAACqD,OAAb;UAAsBC,UAAU,EAAE;QAAlC,EAAX;QAAA;MAAA,EAHA,EAIA,MAAC,IAAD;QAAM,KAAK,EAAE;UAACrC,KAAK,EAAE,MAAR;UAAgBsC,UAAU,EAAE;QAA5B,CAAb;QAAA,WACI,KAAC,YAAD;UAAc,WAAW,EAAC;QAA1B,EADJ,EAEI,KAAC,YAAD;UAAc,WAAW,EAAC;QAA1B,EAFJ,EAGI,KAAC,YAAD;UAAc,WAAW,EAAC;QAA1B,EAHJ,EAII,KAAC,YAAD;UAAc,WAAW,EAAC;QAA1B,EAJJ;MAAA,EAJA,EAUA,KAAC,IAAD;QAAM,KAAK,EAAE;UAACvC,MAAM,EAAEA,MAAM,GAAE;QAAjB;MAAb,EAVA,EAWA,MAAC,IAAD;QAAM,KAAK,kCAAMhB,MAAM,CAACwD,OAAb;UAAsBF,UAAU,EAAE;QAAlC,EAAX;QAAA,6BAAmE7B,UAAU,CAACgC,OAAX,CAAmB,CAAnB,CAAnE;MAAA,EAXA,EAYA,KAAC,IAAD;QAAM,KAAK,EAAE;UAACzC,MAAM,EAAEA,MAAM,GAAE;QAAjB;MAAb,EAZA,EAaA,KAAC,UAAD;QAAY,IAAI,EAAC,KAAjB;QAAuB,OAAO,EAAE;UAAA,OAAIgB,GAAG,EAAP;QAAA;MAAhC,EAbA;IAAA,EAFJ,EAiBKZ,SAAS,IAAE,KAAC,iBAAD;MAAmB,IAAI,EAAC,OAAxB;MAAgC,KAAK,EAAC;IAAtC,EAjBhB;EAAA,EADF;AAqBD"},"metadata":{},"sourceType":"module"}