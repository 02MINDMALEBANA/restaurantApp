{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); enumerableOnly && (symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; })), keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = null != arguments[i] ? arguments[i] : {}; i % 2 ? ownKeys(Object(source), !0).forEach(function (key) { _defineProperty(target, key, source[key]); }) : Object.getOwnPropertyDescriptors ? Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)) : ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } return target; }\n\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport ScrollView from \"react-native-web/dist/exports/ScrollView\";\nimport useWindowDimensions from \"react-native-web/dist/exports/useWindowDimensions\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport React, { useState, useEffect } from \"react\";\nimport styles from \"./styles\";\nimport SecHeader from \"../components/SecHeader\";\nimport CustomeBtn from \"../components/CustomeBtn\";\nimport Card from \"../components/Card\";\nimport Logout from \"../components/Logout\";\nimport { getDocs, collection, query, where, onSnapshot } from 'firebase/firestore';\nimport { auth, firestore } from \"./firebaseConfig/firebase\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nexport default function Cart(_ref) {\n  var navigation = _ref.navigation;\n\n  var _useWindowDimensions = useWindowDimensions(),\n      height = _useWindowDimensions.height,\n      width = _useWindowDimensions.width;\n\n  var _useState = useState(false),\n      _useState2 = _slicedToArray(_useState, 2),\n      isPopUp = _useState2[0],\n      setIsPopUp = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      cartData = _useState4[0],\n      setCardData = _useState4[1];\n\n  var _useState5 = useState(0),\n      _useState6 = _slicedToArray(_useState5, 2),\n      totalPrice = _useState6[0],\n      setTotalPrice = _useState6[1];\n\n  var _useState7 = useState(true),\n      _useState8 = _slicedToArray(_useState7, 2),\n      isLoading = _useState8[0],\n      setIsLoading = _useState8[1];\n\n  function toPayment() {\n    navigation.navigate('Payment', {\n      totalPrice: totalPrice\n    });\n  }\n\n  function prevPage() {\n    navigation.goBack();\n  }\n\n  function logout() {\n    navigation.navigate('Login');\n  }\n\n  var userId = auth.currentUser.uid;\n\n  function getData() {\n    return _getData.apply(this, arguments);\n  }\n\n  function _getData() {\n    _getData = _asyncToGenerator(function* () {\n      var collectionRef = collection(firestore, 'cart');\n\n      try {\n        var dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\n        onSnapshot(dataQuery, function (snapshot) {\n          var data = snapshot.docs.map(function (doc) {\n            return _objectSpread({}, doc.data());\n          });\n          setCardData(data);\n        });\n      } catch (e) {\n        console.log(e.message);\n        setIsLoading(false);\n      }\n    });\n    return _getData.apply(this, arguments);\n  }\n\n  useEffect(function () {\n    getData();\n    var interval = setTimeout(function () {\n      setIsLoading(false);\n    }, 10000);\n    return function () {\n      return clearInterval(interval);\n    };\n  }, []);\n\n  var _useState9 = useState(0),\n      _useState10 = _slicedToArray(_useState9, 2),\n      cartValue = _useState10[0],\n      setCartValue = _useState10[1];\n\n  useEffect(function () {\n    var collectionRef = collection(firestore, 'cart');\n\n    try {\n      var dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\n      onSnapshot(dataQuery, function (snapshot) {\n        var data = snapshot.docs.map(function (doc) {\n          return _objectSpread(_objectSpread({}, doc.data()), {}, {\n            id: doc.id\n          });\n        });\n        setCartValue(data.length);\n      });\n    } catch (e) {\n      console.log(e.message);\n    }\n  }, []);\n  useEffect(function () {\n    var temp = 0;\n\n    for (var i = 0; i < cartData.length; i++) {\n      temp = temp + parseFloat(cartData[i].totPrice);\n    }\n\n    setTotalPrice(temp);\n  }, [cartData]);\n  return _jsxs(SafeAreaView, {\n    style: styles.container,\n    children: [isPopUp && _jsx(Logout, {\n      logout: logout,\n      setIsPopUp: setIsPopUp\n    }), _jsxs(View, {\n      style: {\n        marginTop: '8%'\n      },\n      children: [_jsx(SecHeader, {\n        setIsPopUp: setIsPopUp,\n        cartValue: cartValue,\n        prevPage: prevPage\n      }), _jsxs(ScrollView, {\n        style: {\n          width: width,\n          height: height * 0.80\n        },\n        children: [_jsx(Text, {\n          style: _objectSpread(_objectSpread({}, styles.catText), {}, {\n            marginLeft: '5%'\n          }),\n          children: \"Cart\"\n        }), cartData.length === 0 && isLoading ? _jsx(ActivityIndicator, {\n          size: \"large\",\n          color: \"#090979\"\n        }) : cartData.length === 0 && !isLoading ? _jsxs(View, {\n          style: {\n            flex: 1,\n            justifyContent: 'center',\n            alignItems: 'center'\n          },\n          children: [_jsx(Text, {\n            style: {\n              fontSize: 20,\n              fontWeight: 'bold'\n            },\n            children: \"No items found\"\n          }), _jsx(Text, {\n            children: \"or no internet connection\"\n          })]\n        }) : cartData.map(function (item, index) {\n          return _jsx(Card, {\n            item: item\n          }, index);\n        })]\n      }), _jsxs(View, {\n        style: {\n          elevation: 6,\n          backgroundColor: '#fff'\n        },\n        children: [_jsxs(View, {\n          style: {\n            width: width * 0.9,\n            marginHorizontal: width * 0.05\n          },\n          children: [_jsxs(Text, {\n            style: styles.catPara,\n            children: [\"Total Price: R\", totalPrice.toFixed(2)]\n          }), _jsx(View, {\n            style: {\n              height: height * 0.05\n            }\n          })]\n        }), _jsx(CustomeBtn, {\n          name: \"Checkout\",\n          onPress: toPayment\n        }), _jsx(View, {\n          style: {\n            height: height * 0.05,\n            width: '100%',\n            backgroundColor: '#fff'\n          }\n        })]\n      })]\n    })]\n  });\n}","map":{"version":3,"names":["React","useState","useEffect","styles","SecHeader","CustomeBtn","Card","Logout","getDocs","collection","query","where","onSnapshot","auth","firestore","Cart","navigation","useWindowDimensions","height","width","isPopUp","setIsPopUp","cartData","setCardData","totalPrice","setTotalPrice","isLoading","setIsLoading","toPayment","navigate","prevPage","goBack","logout","userId","currentUser","uid","getData","collectionRef","dataQuery","snapshot","data","docs","map","doc","e","console","log","message","interval","setTimeout","clearInterval","cartValue","setCartValue","id","length","temp","i","parseFloat","totPrice","container","marginTop","catText","marginLeft","flex","justifyContent","alignItems","fontSize","fontWeight","item","index","elevation","backgroundColor","marginHorizontal","catPara","toFixed"],"sources":["C:/Users/user/Downloads/ResturantApp/pages/Cart.js"],"sourcesContent":["import { View, Text, SafeAreaView, ScrollView, useWindowDimensions, ActivityIndicator } from \"react-native\";\r\nimport React, {useState, useEffect} from \"react\";\r\nimport styles from \"./styles\";\r\nimport SecHeader from \"../components/SecHeader\";\r\nimport CustomeBtn from \"../components/CustomeBtn\";\r\nimport Card from \"../components/Card\";\r\nimport Logout from \"../components/Logout\";\r\nimport {getDocs, collection, query,where, onSnapshot} from 'firebase/firestore';\r\nimport {auth, firestore} from './firebaseConfig/firebase';\r\n\r\nexport default function Cart({navigation}) {\r\n    const {height, width} = useWindowDimensions();\r\n    const [isPopUp, setIsPopUp] = useState(false);\r\n    const [cartData,setCardData] = useState([]);\r\n    const [totalPrice, setTotalPrice] = useState(0);\r\n    const [isLoading,setIsLoading] = useState(true);\r\n    function toPayment(){\r\n        navigation.navigate('Payment',{\r\n          totalPrice: totalPrice,\r\n        })\r\n      }\r\n      function prevPage(){\r\n        navigation.goBack();\r\n      }\r\n      function logout(){\r\n        navigation.navigate('Login')\r\n    }\r\n    \r\n    const userId = auth.currentUser.uid;\r\n\r\n  async function getData() {\r\n    const collectionRef = collection(firestore, 'cart');\r\n\r\n    try {\r\n      let dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\r\n      \r\n      onSnapshot(dataQuery, (snapshot) => {\r\n        let data= snapshot.docs.map((doc)=>({...doc.data()}));\r\n        \r\n        setCardData(data);\r\n      })\r\n      \r\n      \r\n    }catch(e){\r\n        console.log(e.message);\r\n        setIsLoading(false);\r\n    }\r\n}\r\n\r\n\r\n\r\n  useEffect(()=>{\r\n    \r\n    getData();\r\n    const interval = setTimeout(() => {\r\n      setIsLoading(false);\r\n   }, 10000)\r\n  return () => clearInterval(interval);\r\n},[])\r\n\r\nconst [cartValue,setCartValue] = useState(0);\r\nuseEffect(()=>{\r\n  const collectionRef = collection(firestore, 'cart');\r\n  \r\n        try {\r\n          let dataQuery = query(collectionRef, where(\"userId\", \"==\", userId));\r\n          \r\n          onSnapshot(dataQuery, (snapshot) => {\r\n            let data= snapshot.docs.map((doc)=>({...doc.data(), id: doc.id}));\r\n          \r\n            setCartValue(data.length);\r\n          })\r\n          \r\n          \r\n        //   console.log(data.length);\r\n          \r\n        }catch(e){\r\n            console.log(e.message);\r\n        \r\n        }\r\n},[])\r\n\r\nuseEffect(()=>{\r\n  let temp = 0;\r\n  for(let i = 0;i<cartData.length;i++){\r\n   temp = temp + parseFloat(cartData[i].totPrice)\r\n  }\r\n  setTotalPrice(temp)\r\n},[cartData])\r\n  return (\r\n    <SafeAreaView style={styles.container}>\r\n      {isPopUp&&<Logout logout={logout} setIsPopUp={setIsPopUp} />}\r\n        <View style={{marginTop: '8%'}}>\r\n        \r\n        <SecHeader setIsPopUp={setIsPopUp} cartValue={cartValue} prevPage={prevPage} />\r\n       \r\n        <ScrollView style={{width: width, height: height*0.80,}}>\r\n        <Text style={{...styles.catText, marginLeft: '5%'}}>Cart</Text>\r\n        {cartData.length===0&&isLoading?\r\n        <ActivityIndicator size=\"large\" color=\"#090979\" />:cartData.length===0&&!isLoading?\r\n        <View style={{flex: 1, justifyContent: 'center', alignItems: 'center'}}>\r\n                        <Text style={{fontSize: 20, fontWeight: 'bold'}}>No items found</Text>\r\n                        <Text>or no internet connection</Text>\r\n                    </View>\r\n        :cartData.map((item,index)=>{\r\n          return  <Card key={index} item={item} />\r\n        })\r\n        \r\n        }\r\n        \r\n        </ScrollView>\r\n        <View style={{elevation: 6, backgroundColor:'#fff'}}>\r\n        <View style={{width: width*0.9, marginHorizontal: width*0.05}}>\r\n            <Text style={styles.catPara}>Total Price: R{totalPrice.toFixed(2)}</Text>\r\n            <View style={{height: height *0.05}} />\r\n        </View>\r\n        \r\n        <CustomeBtn name='Checkout' onPress={toPayment} />\r\n        <View style={{height: height *0.05, width: '100%', backgroundColor: '#fff'}} />\r\n        </View>\r\n        </View>\r\n    </SafeAreaView>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}